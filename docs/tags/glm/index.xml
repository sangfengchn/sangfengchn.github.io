<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Glm on Sang Feng | 桑峰</title>
    <link>/tags/glm/</link>
    <description>Recent content in Glm on Sang Feng | 桑峰</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 04 May 2021 00:00:00 +0000</lastBuildDate>
    <atom:link href="/tags/glm/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>R语言基本统计</title>
      <link>/post/2021/05/04/blog/</link>
      <pubDate>Tue, 04 May 2021 00:00:00 +0000</pubDate>
      <guid>/post/2021/05/04/blog/</guid>
      <description>&lt;p&gt;本文为笔者在学习b站up主@&lt;a href=&#34;https://space.bilibili.com/43536169?spm_id_from=333.788.b_765f7570696e666f.1&#34;&gt;学术数据分析及可视化&lt;/a&gt;相关视频的笔记。文中只是笔者个人的理解，描述也只是便于自己理解。在使用相关内容时，还需要进一步查看相关的手册或帮助文档。&lt;/p&gt;&#xA;&lt;h1 id=&#34;相关&#34;&gt;相关&lt;/h1&gt;&#xA;&lt;p&gt;cor()用于计算两个向量的相关系数。ggm::pcor()用于计算偏相关系数。这两个函数只能计算相关系数。cor.test(), psych::cor.test和psych::pcor.test()分别计算相关系数和偏相关系数及其显著性检验的结果。&lt;/p&gt;&#xA;&lt;h1 id=&#34;差异性&#34;&gt;差异性&lt;/h1&gt;&#xA;&lt;h2 id=&#34;t检验&#34;&gt;t检验&lt;/h2&gt;&#xA;&lt;p&gt;t.test()用于进行独立样本或配对样本t检验。要求各组内方差相等。相应的非参数版本为wilcox.test()。&lt;/p&gt;&#xA;&lt;h2 id=&#34;方差分析&#34;&gt;方差分析&lt;/h2&gt;&#xA;&lt;p&gt;方差分析要求数据满足三个条件，分别是正态性、方差齐性和独立性。独立性一般在实验设计阶段考虑。这里只讨论前两个条件。&lt;/p&gt;&#xA;&lt;h3 id=&#34;对正态性的检验&#34;&gt;对正态性的检验&lt;/h3&gt;&#xA;&lt;p&gt;数据是否满足正态性可以通过直方图hist(), qq图qqplot()和shapiro.test()进行检验。其中shapiro.test()检验的零假设为数据满足正态性。&lt;/p&gt;&#xA;&lt;h3 id=&#34;对方差齐性的检验&#34;&gt;对方差齐性的检验&lt;/h3&gt;&#xA;&lt;p&gt;方差齐性检验可以通过bartlett.test(), leveneTest()和fligner.test()进行。它们的零假设均为各组方差相等。&lt;/p&gt;&#xA;&lt;h3 id=&#34;单多因素方差分析anova&#34;&gt;单/多因素方差分析(ANOVA)&lt;/h3&gt;&#xA;&lt;p&gt;使用aov()。TukeyHSD()用于进行事后检验/多重比较。&lt;/p&gt;&#xA;&lt;h3 id=&#34;单多因素重复测量方差分析ancova&#34;&gt;单/多因素重复测量方差分析(ANCOVA)&lt;/h3&gt;&#xA;&lt;p&gt;aov(y~x+Error(subjects/Group))&lt;/p&gt;&#xA;&lt;h3 id=&#34;非参数方差分析&#34;&gt;非参数方差分析&lt;/h3&gt;&#xA;&lt;p&gt;其中一种利用重采样的方法使用lmPerm::aovp()，用法与aov()类似。&lt;/p&gt;&#xA;&lt;h1 id=&#34;回归&#34;&gt;回归&lt;/h1&gt;&#xA;&lt;h2 id=&#34;回归拟合&#34;&gt;回归拟合&lt;/h2&gt;&#xA;&lt;p&gt;lm()。&#xA;拟合通常用于数据可视化，涉及两个变量之间的关系。目的是找到两个变量之间最合适的关系。&#xA;评价模型好坏的指标有残差标准误$\sqrt{\frac{sum(residual^2)}{n-p-1}}$和决定系数$R^2=1-\frac{RSS}{TSS}$。&#xA;anova(fit, fitnull)可以比较拟合模型与零模型之间是否有差异。零模型一般为$\hat{y}=mean(y)$。&#xA;包aomisc提供了许多不同函数的拟合函数。以线性和指数函数拟合为例。&lt;/p&gt;&#xA;&lt;h3 id=&#34;线性多项式&#34;&gt;线性/多项式&lt;/h3&gt;&#xA;&lt;p&gt;&lt;code&gt;\(y=a+bx+cx^2\)&lt;/code&gt;&#xA;drm(y&lt;del&gt;x, fct=DRC.poly2())等价于lm(y&lt;/del&gt;x+I(x^2)).&lt;/p&gt;&#xA;&lt;h3 id=&#34;指数&#34;&gt;指数&lt;/h3&gt;&#xA;&lt;p&gt;&lt;code&gt;\(y=a*exp(k*x)\)&lt;/code&gt;&#xA;drm(y~x, fct=DRC.expoDecay())&lt;/p&gt;&#xA;&lt;h2 id=&#34;回归分析&#34;&gt;回归分析&lt;/h2&gt;&#xA;&lt;p&gt;回归分析通常用于模型构建预测等，可以包含多个变量。&lt;/p&gt;&#xA;&lt;h3 id=&#34;一般线性模型&#34;&gt;一般线性模型&lt;/h3&gt;&#xA;&lt;p&gt;lm().&#xA;AIC()用于比较模型的好坏，值越小模型越好。也可以用anova()对两个模型是否存在差异进行检验。&#xA;MASS::stepAIC(), leaps::resubsets()和car::subsets()可以筛选纳入模型的变量。car::vif()可以计算自变量的膨胀系数，值越大表示与其他变量的共线性更强。&lt;/p&gt;&#xA;&lt;h3 id=&#34;广义线性模型&#34;&gt;广义线性模型&lt;/h3&gt;&#xA;&lt;p&gt;把因变量按照特定的分布进行转换，以符合特定的概率分布，再利用该分布进行预测。glm()，需要指定函数分布族family。高斯分布的glm与lm的结果是相同的。&#xA;当响应变量为分类变量时，采用logistic（二分类）。glm(formula, data, family=binomial(&amp;rsquo;logit&amp;rsquo;))。涉及三分类及以上时，可以用nnet::multinom()进行建模分析。&lt;/p&gt;&#xA;&lt;h3 id=&#34;线性混合模型&#34;&gt;线性混合模型&lt;/h3&gt;&#xA;&lt;p&gt;nlme和lme4包提供了相关的函数。nlme::lme(), lme4::lmer(). Eg. lme(Richness~NAP, random=&lt;del&gt;1|Beach, data) or lmer(Richness&lt;/del&gt;NAP+1|Beach, data).&lt;/p&gt;&#xA;&lt;h3 id=&#34;广义线性混合模型&#34;&gt;广义线性混合模型&lt;/h3&gt;&#xA;&lt;p&gt;lme4::glmer()和glmmADMB::glmmadmb()提供了相关的建模函数。&lt;/p&gt;&#xA;&lt;h3 id=&#34;其他&#34;&gt;其他&lt;/h3&gt;&#xA;&lt;p&gt;其他还包括贝叶斯回归模型、广义非线性模型和广义非线性混合模型。&lt;/p&gt;&#xA;&lt;h1 id=&#34;参考&#34;&gt;参考&lt;/h1&gt;&#xA;&lt;p&gt;B站UP主@&lt;a href=&#34;https://space.bilibili.com/43536169?spm_id_from=333.788.b_765f7570696e666f.1&#34;&gt;学术数据分析及可视化&lt;/a&gt;。&lt;/p&gt;</description>
    </item>
    <item>
      <title>fMRI上广义线性模型建模简述</title>
      <link>/post/2021/04/09/blog/</link>
      <pubDate>Fri, 09 Apr 2021 00:00:00 +0000</pubDate>
      <guid>/post/2021/04/09/blog/</guid>
      <description>&lt;p&gt;在对&lt;strong&gt;fMRI&lt;/strong&gt;数据，尤其是&lt;strong&gt;task-fMRI&lt;/strong&gt;数据进行分析的时候，利用广义线性模型进行建模是很重要的一步。这里简单记录一下自己关于这部分的理解。&lt;/p&gt;&#xA;&lt;p&gt;我们的大脑每时每刻都在活动，也就造成了&lt;u&gt;&lt;strong&gt;血氧水平的变化（BOLD）&lt;/strong&gt;&lt;/u&gt;。理论上在接收到刺激以后，大脑BOLD信号的变化符合&lt;u&gt;&lt;strong&gt;血氧动力学函数（HRF）&lt;/strong&gt;&lt;/u&gt;。但是考虑到各种因素，最终大脑的变化是非常复杂的。磁共振技术可以用来收集大脑的&lt;strong&gt;BOLD&lt;/strong&gt;信号。在每个&lt;strong&gt;TR&lt;/strong&gt;内，都会生成一个全脑或者一定范围内大脑活动的三维图像。对于其中的一个体素来说，假设它的信号为**$y$**。这里只考虑一种刺激条件的情况。如图1所示。&lt;/p&gt;&#xA;&lt;center&gt;&#xA;    &lt;img style=&#34;width:50%;&#34; &#xA;    src=&#34;index.assets/1543711-20200921120755906-920246107.png&#34;&gt;&#xA;    &lt;br&gt;&#xA;    &lt;div style=&#34;color:orange; border-bottom: 1px solid #d9d9d9;&#xA;    display: inline-block;&#xA;    color: #999;&#xA;    padding: 2px;&#34;&gt;图2. 理论上，BOLD信号和体素y信号的关系。&lt;/div&gt;&#xA;&lt;/center&gt;&#xA;&lt;p&gt;当给予刺激之后，根据刺激的时间、时长和HRF，我们可以估计出某个体素理论上的BOLD信号。然后在这段时间内进行采样，就可以得到一系列的**$y$&lt;strong&gt;和对应理论上的BOLD信号&lt;/strong&gt;$x$&lt;strong&gt;（图2）。通过广义线性模型，我们就可以估计出相应的系数&lt;/strong&gt;$\beta$**。&lt;/p&gt;&#xA;&lt;center&gt;&#xA;    &lt;img style=&#34;width:50%;&#34; &#xA;    src=&#34;index.assets/1543711-20200921120811421-347078361.png&#34;&gt;&#xA;    &lt;br&gt;&#xA;    &lt;div style=&#34;color:orange; border-bottom: 1px solid #d9d9d9;&#xA;    display: inline-block;&#xA;    color: #999;&#xA;    padding: 2px;&#34;&gt;图2. 通过采样之后BOLD信号和体素y信号的关系&lt;/div&gt;&#xA;&lt;/center&gt;</description>
    </item>
  </channel>
</rss>
